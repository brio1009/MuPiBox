<ion-header class="player-header">
  <ion-toolbar color="light">
    <ion-buttons slot="start">
      <ion-back-button icon="arrow-back-outline" [defaultHref]="'media/{{ media().category }}/{{ media().folderName }}'"></ion-back-button>
    </ion-buttons>
    <ion-title class="toolbar-album">
      <div>
      @switch (media().type) {
        @case ('spotifyPlaylist') {
          {{ spotify()?.item.album.name }}
        }
        @case ('spotifyEpisode') {
          {{ episode()?.show.name }}
        }
        @case ('local') {
          {{ local()?.album }}
        }
        @default {
          {{ media().folderName }}
        }
      }
      </div>
    </ion-title>
    <ion-title class="toolbar-tracktitle">

      <div>
        @switch (media().type) {
          @case ('spotifyPlaylist') {
            {{ spotify()?.item.name }}
          }
          @case ('spotifyEpisode') {
            {{ episode()?.name }}
          }
          @case ('local') {
            {{ local()?.currentTrackname }}
          }
          @case ('rss') {
            {{ media().name }}
          }
        }
      </div>
    </ion-title>
    <ion-title class="toolbar-tracknumber" slot="end">
      <div>{{local()?.volume}}%</div>

      <div>
        @switch (media().type) {
          @case ('spotifyPlaylist') {
            {{ spotify()?.item.track_number }}/{{ spotify()?.item.album.total_tracks }}
          }
          <!-- TODO: Check if audiobook can also be episode.
           Commit: https://github.com/splitti/MuPiBox/commit/5b9a71d94331369f01b7450738df500b0849410e -->
          @case ('spotifyEpisode') {
            {{ showTrackNr }}/{{ episode()?.show.total_episodes }}
          }
          @case ('local') {
            {{ local()?.currentTracknr }}/{{ local()?.totalTracks }}
          }
          <!-- ELSE ??: {{playlistTrackNr}}/{{local()?.totalPlaylist}} -->
        }
      </div>
    </ion-title>
    <span slot="end" class="mupihat-icon-container"><mupihat-icon></mupihat-icon></span>
  </ion-toolbar>
</ion-header>

<ion-content class="player-content">
  <ion-grid>
    <ion-row>
      <ion-col size="6">
        <ion-card class="cover-card">
          <img src="{{this.img()}} " draggable="false" style="-user-select: none;" ondragstart="return false;">
        </ion-card>
      </ion-col>

      <ion-col size="6">
        <ion-grid class="controls">
          <ion-row class="slider-row">
            @if (media().type !=='radio') {
              <ion-range [(ngModel)]="progress" max="100" (ionChange)="seek($event)" ion-range></ion-range>
            }
          </ion-row>

          <ion-row class="controls-row">
            <ion-col size="4" class="ion-text-center">
              <ion-button (click)="volDown()" color="light">
                <ion-icon slot="icon-only" name="volume-low-outline" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
            <ion-col size="4" class="ion-text-center">
              <ion-button (click)="playing() ? pause() : play()" color="light">
                <ion-icon slot="icon-only" [name]="playing() ? 'pause' : 'play'" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
            <ion-col size="4" class="ion-text-center">
              <ion-button (click)="volUp()" color="light">
                <ion-icon slot="icon-only" name="volume-high-outline" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
          </ion-row>

          <ion-row class="controls-row">
            <ion-col size="6" class="ion-text-center">
              <!-- [disabled]="this.media.showid" -->
              <ion-button (click)="skipPrev()" color="light">
                <ion-icon slot="icon-only" name="play-skip-back" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
            <ion-col size="6" class="ion-text-center">
              <ion-button (click)="skipNext()" color="light">
                <ion-icon slot="icon-only" name="play-skip-forward" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
          </ion-row>

          <ion-row class="controls-row">
            <ion-col [size]="media().allowShuffle ? '4' : '6'" class="ion-text-center">
              <ion-button (click)="seekBack()" color="light">
                <ion-icon slot="icon-only" name="play-back" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
            @if (media().allowShuffle) {
              <ion-col size="4" class="ion-text-center">
                <ion-button (click)="toggleshuffle()" [color]="media().shuffle ? 'dark' : 'light'">
                  <ion-icon slot="icon-only" name="shuffle-outline" class="small-icon"></ion-icon>
                </ion-button>
              </ion-col>
            }
            <ion-col [size]="media().allowShuffle ? '4' : '6'" class="ion-text-center">
              <ion-button (click)="seekForward()" color="light">
                <ion-icon slot="icon-only" name="play-forward" class="small-icon"></ion-icon>
              </ion-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
